'
' sdlBasic game: paradroid
' 
'   Name:      paradroid.sdlbas
'   Purpose:   simple clone of paradroid media used is freedrorid 
'  Author:     __vroby__    ( __vroby__@libero.it )
'  Licence:    LGPL
'
' Bugs:
'
' Todo:
'  
'
'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

include "sdlbas/filegraphics.sdlblib"
include "sdlbas/init.sdlbas"


setdisplay(640,480,32,1)
autoback(25)
dim  map[ 16,16]
'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
sub mapload(livello)
	dim mappa$[16]
	select case (livello)
		case 0
		mappa$ [0]=	"07020202020202020202020202020209"
		mappa$ [1]=	"06000000000000000000000000000004"
		mappa$ [2]=	"06000000000000000000000000000004"
		mappa$ [3]=	"06000000000007080900000000000004"
		mappa$ [4]=	"06000000000004050600000000000004"
		mappa$ [5]=	"06000000000001020300000000000004"
		mappa$ [6]=	"06000000000000000000000000000004"
		mappa$ [7]=	"06000000000000000000000000000004"
		mappa$ [8]=	"06000000000000000000000000000004"
		mappa$ [9]=	"06000000500000005000000000000004"
		mappa$ [10]=	"06000000000000000000000000000004"
		mappa$ [11]=	"06000000000000000000000000000004"
		mappa$ [12]=	"06000000000000000000000000000004"
		mappa$ [13]=	"06000000000000000000000000000004"
		mappa$ [14]=	"06380000000000000000000000000004"
		mappa$ [15]=	"01080808080808080808080808080803"
	end select

	n=2
	for y=0 to 15
		for x=0 to 15
			a$=mid$(mappa$[y],x*2+1,2)
			if val(a$)=50 then
				a$="00"
				'bob (n,x*64+8,y*64+8,1)
				n=n+1
			end if	
				
				
			map[x,y]=val(a$)
		next
	next	

end sub
'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
sub drawmap
	for y=0 to 15
		for x=0 to 15
			pasteicon(x*64,y*64,1000+map[x,y])
		next
	next	

end sub

'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

sub game
	livello=0
	while  key(27)=0
		mapload(livello)
		drawmap
		x=320:y=240
		move=0:anim=0
		while key(27)=0
			bob(1,x,y,100+move+int(anim))
			anim=(anim+1)mod 8
			move=0
			if key(k_left)then 
				x=x-4
				move=0
				if map[x/64,y/64]>0 then
					x=x+4
				end if	
			end if
			if key(k_right)then 
				 move=0
				x=x+4
				if map[(x+32)/64,y/64]>0 then
					x=x-4
				end if	

			end if
			if key(k_up)then 
				move=0
				y=y-4
				if map[x/64,y/64]>0 then
					y=y+4
				end if	
			end if
			if key(k_down)then
				move=0
				y=y+4
				if map[x/64,(y+32)/64]>0 then
					y=y-4
				end if	
			end if
		
			offset(x-320,y-240)
			waitvbl
		end while
		cls	
	end while
end sub
'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

sub titolo
	screenopen(6,640,480,0,0,640,480,0)
	text(128,128,16,"paradroid.sdlbas press enter ")
        
	while key(13)=0:waitvbl: end while
	screenclose(6)
end sub
'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

'main loop
sub main
	init
	while key(27)=0
		titolo
		game
	end while
end sub
main